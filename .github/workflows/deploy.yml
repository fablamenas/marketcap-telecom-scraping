name: Deploy Production

on:
  push:
    branches:
      - main
  schedule:
    # 9h00 heure de Paris (8h00 UTC en hiver, 7h00 UTC en été)
    # On utilise 8h00 UTC pour l'heure d'hiver (CET = UTC+1)
    - cron: '0 8 * * 1-5'
    # 18h00 heure de Paris (17h00 UTC en hiver, 16h00 UTC en été)
    - cron: '0 17 * * 1-5'
  workflow_dispatch:  # Permet le déclenchement manuel

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Deploy to Production
        uses: appleboy/ssh-action@master
        with:
          host: ${{ secrets.SSH_HOST }}
          username: ${{ secrets.SSH_USERNAME }}
          key: ${{ secrets.SSH_PRIVATE_KEY }}
          port: 22
          script: |
            /home/fabien/marketcap-telecom-scraping/scripts/deploy.sh
